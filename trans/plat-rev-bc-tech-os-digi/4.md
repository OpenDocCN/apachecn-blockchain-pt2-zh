<title>Platfrom revolution</title> <link href="../styles/stylesheet.css" rel="stylesheet" type="text/css"> 

**第四章**

**每件事的账本**

区块链技术能(和不能)为物联网做什么

 *| ![image](../images/icon.jpg) | **区块链和物联网简介** |

物联网革命正在改变我们的家居生活方式、我们与城市的互动方式以及我们处理消费品的方式。新的使用案例展示了管理我们的数据隐私、安全性和可扩展性的复杂性，这与区块链作为物联网解决方案的主干而设计处理的复杂性相同。

两个被夸大的概念——区块链和物联网——的结合存在将复杂的解决方案应用于简单问题的风险。在本章中，我们首先来看一系列物联网用例。在此基础上，我们接着分析物联网的哪些部分可以从区块链中受益，以及在什么情况下受益。然后，我们研究了区块链带来的独特挑战，并创建了一个衡量风险和收益的框架。最后，我们开发了一种实现两全其美的方法:将物联网平台与区块链技术相结合的集成模式。

区块链风靡全球。我们从未见过如此快的开发和采用速度。因此，在我们最初研究这一章的六个月后，相当多的事情发生了变化。

首先，比特币和以太坊等几个区块链面临过早成功的赎金，规模问题变得越来越令人担忧，导致大瓶颈、延迟和更高的交易费用。

第二，尽管缺乏规模，大多数区块链的能源消耗仍在持续攀升。这种升级不能继续下去。它在区块链社区引发了大量技术和市场层面的倡议。

现实主义之风席卷了这个领域:不，区块链不是所有物联网问题的通用解决方案。这是一项强大但不成熟的技术，我们必须非常明智地使用它，否则我们的解决方案可能无法扩展，非常耗电，而且非常昂贵——所有这些都是相互关联的。

像本章末尾介绍的这种混合模型已经成为现实世界的标准:尽可能多做链外工作！例如，将你的数据存储在传统系统中，聚合你的所有事务，只锚定你绝对需要的东西。更一般地说，我们现在将这些技术称为“第 2 层”，因为它们在链外执行许多操作。

对区块链的这种务实利用确实有所帮助，但我们的努力不应就此止步。活跃而不懈的社区一直非常积极地提出可伸缩性挑战的技术解决方案。新的验证算法似乎提出了非常耗电和缓慢(由设计)的工作验证共识机制的替代方案。例如，利益证明(PoS)和授权证明(PoA)已经在几个公共测试网络(例如以太坊)上进行了测试，并被新区块链采用。

对这些较弱的共识和验证算法的担忧依然存在。大多数放松规则的尝试都导致了大规模健康的辩论。最终，这些替代方案有削弱分布式账本技术所能提供的东西的风险:对分散协议的信任，而不是对中央权威的信任。

总而言之，物联网的区块链空间已经超越了其膨胀的预期峰值，现在正在更加谨慎地前进，专注于我们真正需要解决的挑战，以适应未来的技术，并了解技术在哪些方面真正有所帮助，在哪些方面没有帮助。换句话说，世界已经学会变得越来越挑剔，现在正在慢慢地审视那些超越宣传的用例。我们正在进入真实世界测试的阶段，为通往生产力高原的漫长道路做准备。

**简介**

这场革命并不是没有自己的一系列问题；它迫使我们开始思考应对前所未有的挑战的新方法。首先，网络的庞大规模要求我们设计越来越分散和分散的系统，包括连接事物和处理它们的数据。然后，随着物联网的成熟，它将收集越来越多有用但也侵入性的数据集，这将有助于最好的个性化应用，但也会威胁到我们的隐私。建立一个值得信任的网络将有助于确保该技术为消费者提供正确的成本效益比。

区块链和更一般的分布式账本技术(DLT)被提出作为革命性的架构，可以解决许多这样的问题，例如分散计算任务，但也消除了对预先建立的信任的需要。然而，将物联网与 DLT 相结合是我们所能达到的最高宣传曲线。因此，我们需要超越宣传，分析物联网的广泛使用案例，并起草一个系统的方法来确定区块链在哪些方面可以帮助我们，在哪些方面不能。特别是，这项研究重点关注区块链和 DLTs 对物联网用例的准备情况。它还提出了一种混合集成架构，使我们能够使用今天的区块链，并限制相对不成熟的技术中固有的风险。

**什么是物联网？**

关于物联网的定义有数百种。让我们使用我们提出的方法:

物联网是一个物理对象的系统，可以被通过各种网络接口通信的电子设备发现、监控、控制或交互，并最终可以连接到更广泛的互联网。 ^([220](23_bm005.html#ch4fnr220))

考虑到这一点，我们需要澄清一下*这个术语的事情。*互联网上的东西不仅仅是智能灯泡或者连接插头。事物可以是整个环境，如智能家居、智能建筑或智能城市，也可以是带有射频识别(RFID)标签或快速响应(QR)代码的对象。它们可以是设备或机器，如具有蓝牙低能耗的 iBeacon、Arduino 板或 Raspberry Pi。它们可以从简单到复杂，从低到高的计算能力。

从标记对象的概念——起源于 Auto-ID Labs，一个在麻省理工学院成立的国际研究实验室集群——产生了更大的物联网概念！1999 年， Auto-ID 实验室致力于使用 RFID 标签自动识别商品，以创建电子标签产品的全球网络，最终优化物流和供应链。实验室成员提出了“物联网”来描述这个全球网络。 ^([221](23_bm005.html#ch4fnr221))

用更专业的术语来说，物联网就是赋予现实世界的事物四种属性的组合:连接、身份、传感和驱动。连通性是第一个也是最相关的方面:一个不涉及将现实世界的对象连接到互联网的应用不应该被称为物联网！

身份也是物联网的重要属性。没有事物的唯一身份，许多用例根本不可能:如果我们没有唯一识别它的方法，我们怎么知道产品来自哪里？我们需要唯一安全地寻址和识别物联网中的事物，就像互联网上的计算机需要唯一的 IP 地址一样。

一旦它们连接起来并具有身份，物联网中的东西就可以提供传感和/或驱动服务。*感知*是事物报告真实世界的能力。例如，传感器可以监控冰箱温度、特定街道的污染水平或零售店的客流量。借助传感技术，通信从物联网传到互联网，再传到云端。*驱动*是事物接收来自互联网的信息并采取行动的能力。想想命令和控制，开灯或关灯，关闭水阀，或者在电网上转售能量。

我们现在认识到物联网是许多领域和用例的总称([图 4-1](#fig4-1) )。其中一些领域彼此差异如此之大，以至于在得出区块链可以帮助物联网的结论之前，我们必须仔细研究每个领域。从广义上讲，我们可以想到以下应用领域: ^([222](23_bm005.html#ch4fnr222))

智能家居(又名家庭自动化)

可穿戴设备(又名量化自我)

智能城市、电网和建筑

·智能制造(又名工业物联网和工业 4.0)

智能物流(又名连接供应链)

关联营销(也称为直接面向消费者)

这些类别有时被进一步分为三大类: ^([223](23_bm005.html#ch4fnr223))

***消费者物联网*，**包括智能家居、可穿戴设备、消费者营销以及智能物流的产品来源端

***商业物联网*，**包括智能物流、智能建筑和互联医疗设备

***工业物联网*，**覆盖智慧城市、智能电网、智能制造

在本章中，我们主要讨论区块链对消费和商业物联网的影响，但我们讨论的大多数挑战和解决方案也适用于工业物联网。

**物联网部署的典型架构**

我们现在对物联网领域有了共同的理解，但还需要一步才能理解区块链可能带来的机会:我们需要理解物联网部署的典型架构。虽然推广如此大的领域具有挑战性，但在物联网部署中使用了大量的常见模式。

典型的物联网部署由以下六个构件组成:

***事物:*** 事物本身，从智能家电到智能供应链中的标签商品

***物联网协议:*** 物联网用来成为网络一部分的底层协议

***网关和边缘计算机:*** 比事物本身略强的机器(典型的路由器、机顶盒或负责将底层协议翻译成互联网和 Web 协议的语音助手)

***互联网*** 物联网的主干，由 IP、TCP 和 UDP 等多种协议组成(不直接或通过网关连接到互联网的东西不被视为物联网的一部分)

***物联网和物联网平台:*** 平台，通常是集中式的，用于通信和管理事物

***应用和系统:*** 物联网中事物的用户(应用通常通过平台与物联网交互，因为应用本身通常与事物本身不在同一网络上)

让我们看看这些构建模块在物联网用例的四个属性中的作用:连接、身份、传感和驱动。

**连接性:成本、功耗和环境**

连通性是指将事物连接到互联网上。理想情况下，我们应该有一个覆盖所有可能使用案例的连接网络，但物联网连接的世界是一个充满竞争的世界:数以千计的标准相互竞争:NFC、Zigbee、蓝牙、Zwave、EnOcean、Thread、低功耗无线保真(Wi-Fi)、LoRa、NB-IoT、SigFox 等等！

虽然其中一些协议是由于大联盟急于通过重新发明轮子来抢占物联网土地而产生的(例如，Zigbee 与 Zwave 与 Thread 与 Bluetooth 或 LoRa 与 SigFox)，但我们有几个很好的理由来使用不同的协议来连接物联网。我们的经验是，我们可以将这些原因归结为三个因素。

成本影响连接的选择。例如，利用现有 Wi-Fi 基础设施的设备可能比需要 SIM 卡或访问低功耗广域网(LPWAN)如 SigFox、NB-IoT 或 LoRa 的设备成本更低。同样，选择的连接类型会影响材料清单，因为连接芯片组的成本各不相同。传统上，那些从具有相对开放规范的大联盟中分离出来的(例如，Wi-Fi，蓝牙)往往是最便宜的，尽管这种区别随着技术的进步而逐渐消失。

能源是另一个因素，因为有些协议比其他协议更耗电。例如，LPWAN 驱动的设备可以依靠电池运行数年，而 Wi-Fi 设备则不能。在比较区块链解决方案时，功耗是一个需要考虑的重要方面，这些解决方案往往非常耗电，尤其是在需要工作证明(PoW)时。

背景会影响协议的选择。例如，偏远的室外环境不太可能利用 Wi-Fi，而会受益于远程解决方案(如 LoRa)或网状网络(如 Zigbee ),其中每个设备本身都成为网络中继。另一方面，智能家居解决方案可以在 Wi-Fi 上很好地工作，因为大多数家庭都有 Wi-Fi 连接。

这些差异表明，我们将无法活着看到一个独特的物联网网络。虽然整合将会发生(例如，我们看到 Zigbee 和 Thread 彼此越来越接近)，但物联网网络仍将是分散的。一个直接的后果是，一些区块链解决方案，例如，那些寻找安全的东西，将不得不处理这种异构性。

**身份:可寻址性和认证**

身份是大多数物联网用例的关键。它包含两个宽泛的概念:可寻址性和认证:我们如何寻址一个事物，以及我们如何确保这个事物是它所呈现的那个人？在物联网中，我们通过给每个东西一个唯一的 IP 地址或者唯一的 URL(统一资源定位器)来处理可寻址性。 ^([224](23_bm005.html#ch4fnr224))

网络也可以帮助物联网进行身份认证，现在有几个物联网解决方案以 SSL/TLS 证书和公钥基础设施的形式使用网络安全。区块链可以通过提出基于广泛使用的加密技术，特别是散列技术的更加灵活和可扩展的识别系统，来帮助改进我们识别事物的方式。

**感知:报道现实世界**

一旦一个东西在互联网上并拥有身份，它通常会开始感知其环境(例如，检测入侵者的门传感器，容器上的温度传感器)，并将这些数据发送到云中的服务。

这些服务通常被称为*物联网平台* ( [图 4-1](#fig4-1) )。物联网平台的主要作用通常是管理连接和存储物联网发送的数据。然而，物联网平台通常提供许多其他服务，如分析引擎和仪表板、规则引擎、机器学习、设备监控、安全管理等。有几种物联网平台:从亚马逊、IBM 或微软等软件巨头创建的平台到初创公司开创的平台，如 Xively、ThingSpeak、ThingWorx 或 EVRYTHNG。

这些平台通常是高可用性和可伸缩的系统。但是，它们归控制该平台的单一商业实体所有。东西的制造商确实拥有一些专有平台(例如 Nest、SmartThings)，而其他的则是独立的，为几个制造商服务(例如 EVRYTHNG、Xively)。其他参与者包括设备制造商和服务提供商(如谷歌、亚马逊)。区块链具有分散平台控制的潜力。

**启动:接收并执行通信**

我们可以通过使用网络协议(例如 HTTPS)或专有应用协议(例如 Zigbee)直接控制事物来管理驱动。在本地控制之上，我们可以通过互联网实现控制，以明确地或通过规则或机器学习算法来远程控制事物。在这个领域，大多数当前的区块链解决方案都有很大的局限性，因为达成共识需要时间，或者因为在当前的区块链上执行交易的速度相对较慢。

**图 4-1**
物联网平台

物联网平台通常提供的一些功能包括管理设备连接和存储非常大的数据集，以及与其他服务和企业系统集成，并提供分析和机器学习。

![image](../images/f134-01.jpg)

*2017 EVRYTHNG。版权所有者授权改编。保留所有权利。evrythng.com[。](http://evrythng.com)*

**区块链和物联网**

在 2017 年 7 月的报告中，Gartner 将区块链置于其炒作曲线的膨胀预期的顶峰，大约需要 5 到 10 年才能达到生产力的平台期。因此，当我们有一把区块链锤子时，今天的一切看起来都像钉子。物联网也不例外，解决物联网问题的区块链解决方案如雨后春笋般涌现。在这样一个被夸大的环境中，我们必须仔细研究物联网的挑战，以了解区块链和 DLT 是否能为这些问题提供真正的解决方案。

**集中式物联网的挑战以及区块链能做什么**

让我们看看最有可能帮助物联网的区块链和分散式架构的独特属性。首先，区块链通常是*分布式*和*分散式。*认识集中式、分散式和分布式架构之间的差异对于评估区块链的优势至关重要([图 4-2](#fig4-2) )。关键的一点是，没有一个玩家可以控制一个分散或分布式系统，因此它更有弹性，更难终止。 ^([225](23_bm005.html#ch4fnr225))

**图 4-2**
集中式、分散式和分布式系统

在计算环境中，一个真正分散的系统更有弹性，不容易被一个实体关闭或控制。

![image](../images/f135-01.jpg)

*2017 EVRYTHNG。版权所有者授权改编。保留所有权利。[evrythng.com](http://evrythng.com)*

例如，以太坊平台允许用户构建在网络上各种分散节点上运行的应用程序(称为 Dapps)。此外，没有中央以太坊服务器，而是一个具有同等权限的分布式节点网络。这种分布式网络是与传统集中式物联网平台架构的根本区别。去中心化不仅意味着控制是分布式的，而且意味着事物可以自主地相互交流。所有这些方面对物联网的未来都很重要，尤其是当我们考虑规模和耐用性时。

物联网区块链的另一个重要特性是其*不变性:*区块链中的交易将被永久记录，一旦执行，就不能被篡改或删除。这一特性与集中式物联网平台有着根本的区别，集中式物联网平台由物品制造商控制，制造商有权控制记录的内容以及是否被修改。与这种不变性密切相关的是在区块链广泛使用散列作为标识符。*哈希*是单向函数，充当数据的指纹；这种为事物提供安全身份的能力对于所有物联网用例都至关重要。哈希与区块链的其他属性相结合，可以构成物联网高效身份解决方案的基础。

最后，*智能合同*对于物联网用例来说是一个强大的概念。物联网平台的一个重要特征是能够运行实时业务规则，作为对感知或驱动事件的响应。例如，当泄漏传感器检测到泄漏时，水阀应该关闭。通常，这些规则运行在大规模基于云的规则引擎(或网关上的规则引擎)中。智能契约可以支持这些类型的用例，并有能力广泛分发业务规则，使它们更具可伸缩性和可信度:智能契约的执行得到保证，并生成不可变的数据踪迹。

如果区块链是一个蹒跚学步的孩子，那么物联网就是一个青少年:随着其炒作曲线的继续，消费物联网出现了几个重大挑战。在我们看来，以下是最重要的。 ^([226](23_bm005.html#ch4fnr226))

**互操作性:一个事物的网络——而不是内部网**

谈到协议，物联网非常分散。虽然许多人梦想用一个物联网协议来统治他们，但有几个联网协议的存在是有充分理由的(例如，成本、电力和部署环境)，也是因为物联网领域强大且高度政治化的联盟，或者说是竞争，如巨头苹果和谷歌之间的竞争。 ^([227](23_bm005.html#ch4fnr227))

这是物联网的一大悖论，物联网应该是*融合*和*互操作性的同义词。*考虑智能家居。随着 X10 等协议早在 1975 年就出现，智能家居并不新鲜，但几乎没有开发出互操作性。相反，该领域遭受了极端的分裂，智能家居协议无法与使用不同(有时是专有)协议的其他供应商的其他设备进行通信。物联网在很大程度上继续加剧这一趋势，它在家庭中创建了物联网，而不是家庭互联网。

作为物联网研究人员和从业者，我们觉得这种异构性辜负了物联网带来事物互操作性的使命。我们寻找一个抽象层，不同的协议可以在其中融合，物联网的概念大约在 2007 年出现。 ^([228](23_bm005.html#ch4fnr228)) 物联网的核心思想是，无论底层网络协议可能是什么，事物都应该使用 Web 协议(例如 HTTP、Websocket)来实现应用层的互操作性。在过去的 10 年中，大量公司已经采用了这种融合物联网协议的方式，并且物联网的其他 Web 标准正在开发中。 ^([229](23_bm005.html#ch4fnr229)) 然而，物联网的互操作性之战远未结束。

区块链和 DLT 同样通常活跃在应用层，在互联网协议(IP、TCP、UDP 等)之上创建新的协议。).由于这些协议被广泛的参与者分发和理解，它们有可能帮助提供物联网互操作性。传统网络协议(如 IPFS)的有趣替代品正在出现，并可能为物联网设备提供有趣的新方面，特别是在去中心化和 P2P 通信方面。 ^([230](23_bm005.html#ch4fnr230))

**信任:分散的、防篡改的、合规就绪的**

也许区块链对物联网最大的潜在贡献是信任问题的解决。如上所述，大多数物联网解决方案都是围绕一个集中式平台构建的。用户对这些平台的信任程度必须很高，因为它们从用户那里收集数据。消费者需要相信物联网平台会安全地管理他们的数据，不会滥用或修改数据。如果我们连接并运行在物联网健康平台之上的健康保险正在修改我们健康跟踪设备的数据，以拒绝我们的一项索赔，会怎么样？如果一个主要的咖啡品牌在修改出处数据，以便给自己贴上“公平贸易咖啡”的标签，会怎么样？如果我们的物联网门锁背后的公司倒闭了，我们能进入我们的家吗？

最近的事件导致消费者越来越怀疑。例如，当一位消费者给了 Garadget 联网车库门开启器一个差评时，Garadget 的创建者拒绝服务器连接到该消费者的单元(ID 2f0036)，从而削弱了消费者对该品牌的信任。这种信任的丧失不仅影响了智能设备市场，也影响了食品和服装行业:有机或公平贸易标签——以及更普遍的产品来源——不再拥有消费者的信任。 ^([232](23_bm005.html#ch4fnr232))

这是区块链最有潜力提供帮助的地方。首先，区块链支持分布式和分散式平台——没有中央权威机构——与物联网平台的集中式结构形成对比。分布式网络和分散式平台上的物联网产品不依赖于单个实体来按预期运行。事实上，市场上最严重的物联网平台都是作为分布良好的高可用性系统构建的。然而，它们由控制平台和与之相连的事物的单一商业实体所拥有。因此，控制是集中的。

第二，区块链是值得信赖的。对于上市的区块链来说尤其如此，但对于以财团为基础、玩家数量充足的区块链来说也是如此。由于区块链交易无法被篡改，我们可以相信物联网设备感应到的数据就是网络将记录的数据。区块链有可能修复公众对产品来源的不信任，这对商业物联网和智能物流是一个积极的因素。众多区块链玩家(比如这个名字恰如其分的出处)已经明白了这种潜力，并且正在为消费品建立基于区块链的信任系统。 ^([234](23_bm005.html#ch4fnr234))

最后，区块链(尤其是智能合同)在法规遵从性方面拥有前所未有的潜力。法规可以被编程为智能合同，具有完全可审计和完全自动化的执行。这种能力在许多物联网领域都很有用，尤其是商业物联网。例如，初创企业 Modum 围绕一项新法规构建了其用例，该法规强制制药供应链的合作伙伴跟踪医药产品的温度。 ^([235](23_bm005.html#ch4fnr235)) 通过将智能物联网传感器与以太坊区块链上的低功耗通信技术和智能合同相结合，Modum 使得确保可审计和防篡改的监管合规性成为可能。

**隐私:数据加密安全，不归中央所有**

人们一致认为，互联网上的隐私已经死亡，它的消亡早有预言。 ^([236](23_bm005.html#ch4fnr236)) 物联网通过收集前所未有的大量个人数据加剧了这种情况。这是一个重要的悖论:物联网的许多好处之所以成为可能，只是因为收集了个人数据。Nest 恒温器学习我们在家的习惯，并在正确的时间自动设置正确的温度。

监管机构已经开始通过制定影响数字世界和物联网的新法律来解决这些隐私问题。例如，欧洲 GDPR 正在执行一套关于公民数字档案权利的严格准则。 ^([237](23_bm005.html#ch4fnr237))

区块链解决方案不一定会改变所收集数据的性质。然而，分散化意味着数据不会属于一个单一的、全能的实体。相反，数据可以被几个参与者审计和利用。这种解决方案还可以帮助消费者重新控制他们的个人数据，并提供更好的方式来利用这些数据。虽然集中式物联网平台包含了大量消费者数据，但我们必须承认，它们也保护这些数据免受不必要的公共访问，而公共区块链根据定义将这些数据提供给每个人。因此，建立正确的加密和混淆机制对于保护区块链的隐私非常重要。 ^([238](23_bm005.html#ch4fnr238))

我们不应低估执行方面的挑战。几项研究表明，即使是适当的匿名数据也可以用来非常准确地识别个人身份。 ^([239](23_bm005.html#ch4fnr239))

**可扩展性:超越自主设备和边缘处理**

可扩展性是物联网中的一个重要问题。为了理解我们正在谈论的规模，让我们考虑一下 Twitter，一个世界范围内使用的社交网络。截至 2021 年 3 月，每天约有 8 亿条推文到达 Twitter 服务器。为了在保持适当延迟的同时处理如此大的数据量，Twitter 开发了一个令人印象深刻的基础设施。现在，假设有 10 万台物联网设备每秒钟向一个物联网平台发送一次更新，即每天约 860 亿次交易，约为每天推文数量的 132 倍，但仍只是预计到 2020 年互联网上 500 亿台设备的一小部分。 ^([241](23_bm005.html#ch4fnr241))

就网络和数据可扩展性而言，物联网代表着前所未有的挑战。物联网产品的成功给其各自的平台带来了越来越大的压力，并可能导致影响物理世界的服务中断。随着物联网渗透到我们日常生活的方方面面，产生的数据量将给互联网基础设施和集中式物联网平台带来越来越大的压力。

大规模分布式系统通常是处理这类问题的明智方式。提高设备的自主性和在边缘(如网关)处理越来越多的数据是解决方案的两个部分。根据定义，区块链是大规模分布的，因此，有可能有助于权力下放和自治。然而，社区仍有工作要做，区块链规模。

**耐久性:维护分布在整个网络**

最后，耐用性是当前物联网产品的一个重要问题。问题不仅仅是“这个物联网产品能用 10 年吗？”还有“它所连接的物联网平台五年后还会存在吗？”这不是科幻小说:许多物联网产品已经停产，许多物联网平台已经破产，给消费者留下的是砖块而不是智能设备。想想智能家居初创公司 Revolv hub，Nest 在收购它后关闭了它，导致连接到它的设备无法使用。或者把相机连接到互联网的 Eyefi 卡怎么样:它通过固件更新变得过时了。 ^([242](23_bm005.html#ch4fnr242)) 此类问题的增多导致美国美国联邦贸易委员会(FTC)局长向物联网设备的制造商发出公开信。 ^([243](23_bm005.html#ch4fnr243))

分权意味着控制权的分配。公共区块链不是由单个实体控制，而是由网络中的所有(或一些，取决于实现)参与者控制。这种分布的强大效果是，关闭区块链相当困难，即使它的一些主要参与者停止使用它。只要少数人认为运行几个节点值得付出成本(如能源)，区块链就可以存在。例如，想象一下 Revolv hub 是基于 DLT 的:设备所有者可以接管并继续运行该系统。此外，我们可以使用智能合约来实现物联网平台的规则引擎。智能合约是持久性的真正优势，因为它们将智能放在网络中，并可以以完全分散的方式驱动用例。

分散化的好处不仅适用于考虑物联网设备的云部分，也适用于考虑设备本身的寿命。例如，区块链可以确保设备可以获得固件更新，远远超出设备制造商承诺的商业合理水平:只要网络中的一台设备拥有最新的固件，所有设备都可以受益。IPFS 正在通过实现 HTTP 的替代方案来解决这个问题。通过使用 DLT，IPFS 在网络上分发文件，使其在服务器消失的情况下具有弹性。 ^([244](23_bm005.html#ch4fnr244))

**物联网区块链的局限性**

总而言之，区块链有望帮助物联网克服弹性、耐用性、可扩展性、信任、隐私和互操作性等挑战。现在，让我们考虑一下区块链尚未解决的挑战，它们带来的新挑战，以及物联网中部署的分布式账本技术的剩余挑战([图 4-3](#fig4-3) )。

**可扩展性、延迟和交易成本**

可伸缩性是最复杂和最有争议的挑战之一，最著名的区块链实现尚未解决，在某些情况下，甚至加剧了这一挑战。特别是，目前比特币和以太坊等公共区块链每秒处理的交易量相对较低:在撰写本文时，比特币约为 7 笔，以太坊约为 25 笔。 ^([245](23_bm005.html#ch4fnr245)) 这种延迟是由不同的因素造成的，其中一些是人为的，与这些公共区块链的 PoW 和分布式一致性要求相关联，这使得它们在设计上很慢并且在并发性方面受到限制。

**图 4-3**
区块链物联网的挑战

区块链和分布式账本技术有可能解决物联网的几个挑战，但也带来了新的挑战。

![image](../images/f143-01.jpg)

*资料来源:Dominique D. Guinard 和 Vlad M. Trifa* ，构建物联网(*庇护岛，纽约:曼宁出版公司，2016)。[webofthings.org/book](http://webofthings.org/book)。在 CC BY 4.0 许可下使用。*

因此，区块链公共场所的微交易需要支付很高的费用。在撰写本文时，一至两美元交易的中间费用是比特币的 34%，以太坊的 8%。 ^([246](23_bm005.html#ch4fnr246) 加上执行加密和确认交易所需的处理能力和时间，以及记录分类账所需的不断增加的存储，我们的系统具有非常有限的物联网适用性，特别是不适合频繁采样的超大规模传感。 ^([247](23_bm005.html#ch4fnr247)))

[图 4-4](#fig4-4) 比较了一个小规模物联网(100，000 台设备连接到一个基于互联网的平台)的交易量与 Twitter 帖子、谷歌搜索和区块链上的交易量。确认交易的延迟(大约几分钟)使得大多数当前的区块链不能用于工业或消费环境中的驱动。想象一下，要等一分钟才能开灯或打开车库门！

**图 4-4**
区块链对物联网的适用性非常有限

将推文、谷歌搜索和区块链的交易量与每秒发送 10 万个并发传感更新的物联网设备的小规模用例进行比较。以太坊(0.3%)和比特币(0.09%)的交易量分别为每秒 25 笔和 7 笔，甚至没有出现在图表中。专用的 DTL IOTA 目前将支持该流量的 0.1%，而 Coco 将支持 1%。

![image](../images/f144-01.jpg)

*数据来源:多米尼克·吉纳德，2017 年。*

可伸缩性和缺乏可伸缩性所带来的延迟是这些区块链未来的主要问题，目前正在进行大量的工作来解决这些问题。由于以太坊和比特币等公共区块链不会帮助解决物联网可扩展性挑战，因此社区正在考虑更高级别的协议。

例如，Ambrosus 项目正在研究使用以太坊来检测和感知食物链。然而，安布罗斯并没有天真地将微交易(例如，一托盘草莓的温度读数)推送到以太坊区块链，而是希望在与区块链同步之前大规模聚合这些事件，并只存储事件的引用，从而将实际事件推送到一个分散的数据库。这种方法使系统在感知物联网用例方面更加可行，但不会解决需要高频更新的用例或驱动用例将面临的延迟问题。这就是为什么 Ambrosus 主要关注物联网(一种以传感为中心的用例)在供应链中的应用。

聚合事务的想法非常合理，其他几个项目也在研究这种模式。例如，批处理事务是 Coco 框架目前在以太网上达到每秒 1600 个事务的原因之一。 ^([249](23_bm005.html#ch4fnr249))

其他人一直在考虑受区块链启发的全新协议，但实现方式完全不同。考虑 IOTA，一个没有块和链的区块链，这意味着它不是真正的区块链——它是分布式账本技术。本质上，IOTA 是基于 *tangle* 的思想，其核心原理与区块链的类似:tangle 是基于 P2P 网络的分布式账本。^(这种方法有效地创建了一个有向无环图(DAG ),并间接证明了该图的一个子部分(缠结)遵守了协议的规则。 ^([251](23_bm005.html#ch4fnr251)))

这种微小的差异有两个非常重要的后果:首先，它意味着整个*网络——而不是一个更小的矿工群体——参与交易的批准，因此 IOTA 中没有交易费用。这种设计解决了物联网传感和驱动用例所需的微交易费用过高的问题。*

其次，tangle 协议支持并行一致性，从而缩短了确认时间，并导致每秒处理更多的事务。作为参考点，250 个 IOTA 节点每秒可以管理大约 100 个事务，确认时间为 10 秒或更短。 ^([252](23_bm005.html#ch4fnr252)) 虽然这一速度与集中式物联网平台的性能相比仍有很大差距，但这是令人鼓舞的，IOTA 团队有信心支持的交易数量将显著增加。

虽然区块链和 DLTs 今天可能无法帮助物联网实现可扩展性，但从长远来看，他们可以通过促进物联网之间的 P2P 通信来提供帮助——这是与今天的操作方式相比的一个重大范式转变。事物可以在更小和更局部的网络中启动通信，而不是依赖于到中央平台的完全连接。在几个区块链的核心加上代币形式的价值交换的概念，我们可以拥有一个自组织的网络，在这个网络中，事情可以在没有中介的情况下执行并获得“支付”。这个用例正是 IOTA 等区块链公司正在探索的那种，它允许在网络上执行无感觉的微交易。例如，布鲁克林微电网项目正在将这些原则应用于其能源电网，其中公民可以自动货币化和交换太阳能电池板和其他可再生能源产生的能源。 ^([253](23_bm005.html#ch4fnr253))

IOTA tangle、Ambrosus 和 Coco 并不是试图解决当前 DLT 和区块链的可伸缩性问题的唯一框架和协议。每天都有新的协议和解决方案出现，并且一步一步地推进可能性的艺术。 ^([254](23_bm005.html#ch4fnr254)) 基准测试和这些新解决方案的系统可扩展性测试将有助于促进实际采用。

**法律方面:监管滞后于创新**

正如每一项快速发展的技术一样，区块链比监管机构领先一步，这导致了多重法律灰色地带。在金融市场监管方面，这一点尤其得到了很好的证明。对于物联网，区块链提出了几个悬而未决的法律问题。例如，GDPR 第 17 条规定了“被遗忘的权利”，这意味着个人可以要求数据控制者删除该控制者掌握的关于该个人的任何或所有数据。

这一规定对于区块链来说显然是有问题的，因为根据设计，交易不能被删除。这也许是最引人注目的例子，但不是唯一的例子，说明监管还没有为权力下放和区块链做好准备。

**互操作性:去中心化和标准化**

区块链有潜力创造一个物联网，在这个物联网中，事物可以自主地相互对话，而不是通过大型的集中式平台。然而，为了让这种通信在物联网规模上工作，我们需要互操作性:事物必须使用一套通用的协议来实现自主、分散的交互——显然在区块链生态系统中这还远远不够。事实上，新的区块链或 DLT 每天都在出现，制造了更多的不兼容性。

这与物联网本身的发展方式没有什么不同。起初，网络嵌入式系统在很大程度上是不兼容的和专有的协议，创建了许多事物的内部网，这在很大程度上仍然是这样。然而，所有这些协议已经开始向 IP 和 TCP/UDP 等互联网协议融合，互操作性正在通过应用层的 Web 协议实现。在许多情况下，区块链解决方案是在互联网上建立竞争的应用协议，增加了另一层不兼容性。例如，比特币协议与以太坊的不兼容。这两种协议形成了独立的大规模分散网络。两者之间的通信需要翻译层。虽然翻译对于大型系统是可行的，但物联网中的嵌入式系统不太可能支持许多分散的协议来相互通信。如果我们希望物联网的全球 P2P 和自主通信蓬勃发展，我们就需要融合。

在国际电信联盟或万维网联盟等标准组织内，许多计划都在关注跨区块链和 DLT 的标准化。其他倡议设计新的分布式协议来实现互操作性，例如，Polkadot 多链技术或 Icon Hyperconnect 系统。 ^([256](23_bm005.html#ch4fnr256))

然而，融合和真正的互操作性需要时间。嵌入式系统向物联网中的互联网和网络技术融合花了数年时间，这一旅程仍在继续。物联网 DLT 标准化的道路很漫长，但这是实现物联网 DLT 分散化潜力的一系列重要步骤。

**能源消耗:对于资源受限的设备来说过高**

区块链的功耗是一个容易被忽视的挑战。2014 年，一项研究表明，比特币区块链消耗的电能与爱尔兰的耗电量相当。 ^([257](23_bm005.html#ch4fnr257)) 更近期的结果展示了比特币相对于其他国家的功耗([图 4-5](#fig4-5) )。 ^([258](23_bm005.html#ch4fnr258))

就能源消耗而言，并非所有的区块链都是平等的。最渴望权力的人依靠权力。例如，为了验证交易，比特币矿工必须找到满足涉及 SHA-256 加密哈希函数的特定方程的值。这是一个计算量非常大的操作——相当于我们可以自己挑选号码的彩票——并且需要大量的能量。这种昂贵操作的需求对于保护区块链免受攻击者的攻击是很重要的:它使得攻击在经济上和计算上都很困难。除了电力之外，分散化和冗余通常会消耗电力。这是一个挑战，因为它使区块链解决方案不太可持续，而且比集中式解决方案昂贵得多。创建优化的硬件和使用新的共识算法可以解决或减轻这些挑战。例如，PoS 不要求耗电机器每秒产生尽可能多的散列。

**图 4-5**
各国能源消耗情况

如果比特币区块链是一个国家，它每年的能源消耗将排在第 38 位，高于澳大利亚、孟加拉国和智利。

![image](../images/f149-01.jpg)

*数据来源:“比特币能源消耗”，[Digiconomist.net](http://Digiconomist.net)，截至 2021 年 3 月 9 日。[digiconomist.net/bitcoin-energy-consumption](http://digiconomist.net/bitcoin-energy-consumption)。*

区块链的高电力需求也是物联网中的一个问题。众多物联网用例运行低功耗设备，因为它们需要长时间依靠电池运行，或者因为低功耗硬件更便宜。这意味着许多区块链和 DLT 协议不太适合资源受限的设备:它们可以在网关上工作，但不能在物联网的一些更受限的节点上工作。

除了可扩展性之外，解决区块链技术的功耗问题是一个重要的挑战，需要优先考虑以确保开发中的解决方案的可持续性和未来防护性。

**不成熟:未做好生产准备**

最后，DLT 为物联网带来的最大挑战可能是当前解决方案的不成熟。物联网和纯 Web 应用之间的最大区别在于，物联网部署会对物理世界产生影响，而物理世界的参与规则根本不同。人们可能会反对每月升级冰箱的想法，因为一个新的 DLT 已经出现，或者因为区块链协议没有真正达到预期的规模。

现实世界的设备和过程需要能够依赖于经过验证的技术，这些技术将持续多年而不会发生根本性的变化。集中式物联网系统和协议刚刚达到某种成熟水平。DLT 社区在很大程度上意识到工具和协议的不成熟，大多数实现被其作者标记为“测试版”或“实验版”:“区块链还没有做好生产准备，现在讨论的大多数用例都不能大规模执行。” ^([259](23_bm005.html#ch4fnr259))

然而，DLT 发展的速度实际上非常令人鼓舞:计算机科学领域很少以如此快的速度发展。尽管如此，专家估计，在 DLT 达到成熟和大规模采用之前，我们还需要等待大约十年。 ^([260](23_bm005.html#ch4fnr260))

**实施物联网区块链**

DLTs 和区块链带来的优势和挑战的特定组合并不一定使设计选择非常简单。正如我们所看到的，一些标准，如潜在的更好的可伸缩性，还有待证明。因此，我们应该关注与我们的物联网用例相关的区块链的独特功能。我们特别考虑三个问题:

**1。**我们需要修复不信任吗？

**2。**我们需要进行多方交易吗？

**3。我们需要分散和分布计算吗？**

如果我们对这三个问题的答案都是肯定的，那么区块链可能是一个可行的解决方案。

**面向现在和未来的集成架构**

如果区块链对我们的用例有意义，那么下一个问题是，“我们如何设计一个集成？”我们可以在区块链或 DLT 生态系统的基础上重建物联网平台的功能，但我们提出了一种方法，通过利用现有的物联网平台来最大限度地降低风险，同时建立一座通往 DLT 创新的桥梁。

这个想法的核心是继续通过集中式平台将事物连接到物联网，但开始将一些数据传播到区块链或 DLT。图 4-6 说明了网络事物模型。 ^([261](23_bm005.html#ch4fnr261)) 使用这种模型连接的事物具有 URL 形式的网络身份。我们使用对应于设备身份的区块链散列(例如，使用区块链身份服务)来扩展事物身份，从而利用区块链上身份的安全性和信任，同时保持网络上的可寻址性。

**图 4-6**
扩展 WEB 物模型

下面是我们如何在 EVRYTHNG 平台中扩展 Web Thing 模型来同步区块链的重要事件。

![image](../images/f152-01.jpg)

*2017 EVRYTHNG。版权所有者授权改编。保留所有权利。[evrythng.com](http://evrythng.com)turkkub 的全球免费图标，在 flat icon 2019 年 6 月许可下使用。*

类似地，在这个模型中，一个东西接收许多动作，这些动作代表它从物联网平台接收的驱动命令。我们可以将这些动作作为事务(例如以太坊事务)或批量事务散列并存储在区块链中，这将提供可信且不可变的动作跟踪。

属性代表一个事物感知到的数据。由于交易费用和可伸缩性的原因，在公共区块链中大规模存储这些数据可能会有问题，但我们可以定期将它们聚合并同步到区块链，或者将它们发送到分散的数据库。 ^([262](23_bm005.html#ch4fnr262))

最后，物联网平台提供了运行业务逻辑和规则的规则引擎。这些在设备和平台之间形成契约。在集中式平台中，我们可以保持当感测或驱动数据到达平台时触发的实时规则(例如，温度阈值、设备的预防性维护)。我们可以将要求强可审计性或多方协议的特定规则转化为以太坊等区块链上的智能合同。

这种架构的优势在于，在一个成熟的集中式物联网平台中保持核心操作，同时准备利用区块链在许多数据点、操作和规则方面的未来优势。

**二等兵区块链**

为了应对其中的一些挑战，替代模型出现了:从公共区块链，一些开发商进入了“私人区块链”或混合“基于财团的区块链”(又名联合区块链)或 DLTs 的概念。例如，Hyperledger 区块链堆栈或科达 DLT 项目支持众多的研究人员或企业作为私人或财团为基础的区块链。 ^([263](23_bm005.html#ch4fnr263)) 这些项目不是可公开访问的分布式系统；它们是封闭的系统，只有有限数量的合作伙伴可以访问。他们对于区块链就像内部网对于互联网一样。

虽然我们认为私营区块链没有什么价值，但采取基于财团的方式有两个优势。首先，它可以作为一个受控实验运行，从而缓解不成熟的问题。其次，它可以通过限制和控制应用程序的吞吐量来隐藏可伸缩性问题。尽管如此，非公有区块链或 DLT 失去了它们本身的几个优势:尽管它们基于去中心化的技术，但它们是由一小部分控制系统命运的参与者建立的。

**耐用物联网系统指南**

由于事物仍然通过充当区块链代理的集中式平台进行通信，这种混合架构不是完全分散的，因此不能保证弹性和持久性。这里有四个指导方针，可以确保今天连接到物联网的东西明天能够过渡到不同的分散系统。指导方针很简单:

使用开放协议。物联网应该使用开放协议，而不是专有协议。尽可能选择 IP 和 TCP/UDP(直接或通过本地网关)等互联网协议用于网络连接，并选择开放应用协议(如 HTTP、Websocket、MQTT、CoAP 等)。)以及对应用程序连接的广泛社区支持。这确保了从一个物联网平台切换到另一个平台是可能的，而无需完全重新考虑设备使用的协议。

**在云端公开 API。**物联网平台应使用 HTTP 和 Websocket 等支持良好的 Web 协议来公开开放 API，以确保消费者在从一个平台过渡到另一个平台时可以检索数据和配置。

**依赖本地运营—不依赖云。**即使云提供商消失了，物联网中的核心功能也应该工作。此外，平台应该提供本地 API(例如，本地 HTTP 或 CoAP API)或至少一个本地接口，允许切换到不同的云提供商或本地上传不同的固件。

这三个准则的结合确保了消费者能够在物联网提供商消失时将他们的设备切换到其他提供商。易切换保证了物联网设备一定的耐用性；未来，设备将能够发展成更加分散的系统。

**建立正确的法律框架。**监管机构应实施保护消费者并确保物联网可持续发展的规则。为了确保合规性，我们可以使用区块链来实施这些法规。

![image](../images/icon.jpg) **结论和建议**

很少有技术发展如此迅速，并产生了区块链和 DLTs 的影响。围绕这些新系统的兴趣清楚地表明，它们将彻底改变众多市场，包括物联网。

**DLT 可以解决物联网面临的一些问题。**特别是，它可以帮助克服物联网在未来十年将面临的重要可扩展性挑战。事实上，通过提出物联网之间的自主和基于契约的通信，DLT 可以帮助实现物联网中的去中心化，并让它们依赖于弹性全球网络而不是少数集中式平台。

物联网的未来很可能会倾向于全数字化。数十亿联网设备将必须能够自主工作，并动态适应快速变化的规则。这种超大规模物联网只有在分散化和自治的情况下才能持续。这就是区块链和更广泛的 DLT 有潜力提供帮助的地方:他们肯定会成为未来大规模分布式和分散式网络的根源。

**DLT 仍处于起步阶段，尚未准备好投入生产。**他们目前的进化是一个前所未有的现实世界研究项目，研究是对研究之外的世界(例如，金融世界)产生直接影响的试验。因此，该领域的发展速度可能会比我们在传统研究领域中所习惯的速度快得多。然而，这项新技术的制造者并不傻，他们意识到他们还没有投入到大规模生产中。 ^([264](23_bm005.html#ch4fnr264)) 在大规模部署之前，有几大挑战需要解决，最重要的是可扩展性和能耗。

**物联网就在此时此地，在所有市场！**物联网市场围绕连接、识别、传感、远程监控和驱动展开。公司正忙着在所有部门部署联网的东西，触及所有市场。没有接受数字化的公司已经面临过时的风险。

**放权可以等；物理世界的数字化不能。**非常明智地选择物联网战略。专家估计，在接下来的两年里，多达 90%的区块链飞行员将会失败。 ^([265](23_bm005.html#ch4fnr265)) 虽然我们可以在数字世界的抽象层中隐藏技术的不成熟，但我们不能忽视现实世界中的更新周期、物理约束和安全法规，这些都使得物联网很难基于新兴技术。

**许多物联网用例在没有区块链或 DLT 的情况下也能工作。**在实施完整的区块链之前，仔细检查各种功能——信任、多方事务以及分散和分布式计算。当心区块链的替代实施，如私人区块链，这往往使公司暴露于所有不成熟的挑战，而没有公共区块链的好处。请记住 CompuServe 对于网络的意义以及它是如何消失的。

DLT 在物联网方面的潜力是不可否认的。从混合架构开始，集中系统的数据可以在区块链共享和利用。尝试权力下放和全球信任。开始思考这些新的分布式账本技术可以取代集中式解决方案的哪些子部分。最后，构建当今物联网的机制，防止锁定专有的集中式平台，以便为适应分布式账本技术做好准备。

**编者按**

既然我们已经从区块链技术的角度讨论了大数据、人工智能和物联网，让我们停下来回顾一下。万维网是一个只读平台(Web 1.0)，用于发布信息、按语法搜索和消费内容。这是一个由热情的技术专家管理的分布式网络。我们今天使用的社交网络是一个读写平台(Web 2.0)，不仅用于与内容及其创作者进行交互，还用于在全球范围内与人们进行协作。虽然底层技术在标准方面仍有其 Web 1.0 管家，但网络已被专制政权中的国家利益和民主政权中的商业利益所吸收。对访问、隐私和言论自由的控制要集中得多。

物联网、区块链和人工智能的出现带来了语义网(Web 3.0)，这是一个分散的网络，物联网上的数万亿设备生成传感器直接的数据，分布式账本记录并保护这些数据，人工智能分析数据，与事物交流，警告它们的主人，并不断调整和提高生态系统的效率及其对环境影响的可持续性([图 4-7](#fig4-7) )。

**图 4-7**
区块链、AI、IoT 围绕数据的三次崛起

Web 3.0 将运行在分布式云中，而不是企业计算平台上。

![image](../images/f158-01.jpg)

*“区块链”、“芯片”和“世界网格”，由 Freepik 根据 flat icon 2019 年 6 月许可使用。*

企业计算的时代即将结束:Web 3.0 将在分布式云中运行，这是地理上分散的公共和私有服务器的某种组合，具有边缘计算能力。这些对于保护公共资源非常重要，如自动驾驶汽车和充电站的交通网络，这是第 5 章和第 6 章的主题。

我们必须确保这一网络的治理或管理是分布式的，是量子验证的，公民、倡导团体、企业家、发展中经济体和中小企业在网络的治理、运营和标准化方面拥有与大公司、非政府组织和全球大国一样多的发言权。这些是第 7 章和第 8 章[的主题。请继续阅读！](18_ch008.html)*